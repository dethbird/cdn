{% extends 'layout.twig' %}

{% block title %}Upload preview{% endblock %}

{% block content %}
  <div class="box">
    <h2 class="title is-4">Upload preview</h2>
    {% set info = upload_info %}
    <div style="display:flex;gap:1.5rem;align-items:flex-start">
      <div style="flex:0 0 360px">
        {% if info.kind == 'image' and info.url_800 %}
          <img src="{{ info.url_800|e }}" alt="{{ info.title|e }}" style="max-width:100%;border:1px solid #eee;padding:4px;background:#fff" />
        {% elseif info.kind == 'audio' and info.url_main %}
          <audio controls style="width:100%">
            <source src="{{ info.url_main|e }}" />
            Your browser does not support audio playback.
          </audio>
        {% else %}
          <div class="notification is-warning">No preview available</div>
        {% endif %}
      </div>
      <div style="flex:1">
        <table class="table is-fullwidth">
          <tbody>
            <tr><th>Title</th><td>{{ info.title|e }}</td></tr>
            <tr><th>Project</th><td>{{ info.project|e }}</td></tr>
            <tr><th>Kind</th><td>{{ info.kind|e }}</td></tr>
            <tr><th>MIME</th><td>{{ info.src_mime|e }}</td></tr>
            <tr><th>Size</th><td>{{ info.bytes is defined ? info.bytes : 'unknown' }}</td></tr>
            <tr><th>Dimensions</th><td>{% if info.width and info.height %}{{ info.width }}x{{ info.height }}{% else %}-{% endif %}</td></tr>
            <tr><th>Duration</th><td>{% if info.duration_sec is defined and info.duration_sec %}{{ info.duration_sec|number_format(2, '.', '') }}s{% else %}-{% endif %}</td></tr>
            <tr><th>Ext</th><td>{{ info.ext|e }}</td></tr>
            <tr><th>Created</th><td>{{ info.created_at is defined ? info.created_at|date("F j, Y g:i:s") : '-' }}</td></tr>
            <tr><th>URLs</th><td>
              {% if info.url_1200 %}<div><a href="{{ info.url_1200|e }}" target="_blank">1200</a></div>{% endif %}
              {% if info.url_800 %}<div><a href="{{ info.url_800|e }}" target="_blank">800</a></div>{% endif %}
              {% if info.url_320 %}<div><a href="{{ info.url_320|e }}" target="_blank">320</a></div>{% endif %}
              {% if info.url_main and info.kind == 'audio' %}<div><a href="{{ info.url_main|e }}" target="_blank">mp3</a></div>{% endif %}
            </td></tr>
          </tbody>
        </table>
        <div style="margin-top:1rem">
          <a class="button is-primary" href="/">Continue to admin</a>
        </div>
      </div>
    </div>
  </div>
{% endblock %}
