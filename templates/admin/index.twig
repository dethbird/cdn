{% extends 'layout.twig' %}

{% block title %}Personal CDN{% endblock %}

{% block content %}
  <h1 class="title site-header">Personal CDN</h1>
  {% if upload_info is defined %}
    <div class="notification is-success">
      <strong>Upload received</strong>
      <div>Title: {{ upload_info.title|e }}</div>
      <div>Project: {{ upload_info.project|e }}</div>
      <div>Filename: {{ upload_info.filename|e }}</div>
      <div>Size: {{ upload_info.size is not null ? upload_info.size : 'unknown' }}</div>
      <div>Type: {{ upload_info.media_type|e }}</div>
    </div>
  {% endif %}
  <div class="box">
    <div style="display:flex;justify-content:space-between;align-items:center;gap:1rem">
      <form method="get" class="field has-addons" style="flex:1">
      <div class="control is-expanded">
        <input class="input" name="project" placeholder="filter by project" value="{{ project|e }}" />
      </div>
      <div class="control">
        <button class="button is-info">Filter</button>
      </div>
      </form>
      <div>
        <a class="button is-primary" href="/upload">Add</a>
      </div>
    </div>
  </div>

  <div class="box">
    <div class="table-container">
      <table class="table is-fullwidth is-hoverable">
        <thead>
          <tr><th>Kind</th><th>Project</th><th>Title</th><th>Size</th><th>Created</th><th>URL</th><th>Renditions</th><th>Copy</th></tr>
        </thead>
        <tbody>
          {% for it in items %}
            <tr>
              <td class="has-text-weight-semibold">{{ it.kind|e }}</td>
              <td>{{ it.project|e }}</td>
              <td>{{ it.title|e }}</td>
              <td>{{ it.size_human }}</td>
              <td>{{ it.created_at }}</td>
              <td class="url"><a href="{{ it.url_main|e }}" target="_blank">{{ it.url_main|e }}</a></td>
              <td>
                {% if it.url_1200 %}<div><a href="{{ it.url_1200|e }}" target="_blank">1200</a></div>{% endif %}
                {% if it.url_800 %}<div><a href="{{ it.url_800|e }}" target="_blank">800</a></div>{% endif %}
              </td>
              <td><button class="button is-small is-info" onclick="copyUrl('{{ it.url_main|e('js') }}')">Copy</button></td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
  
{% endblock %}
